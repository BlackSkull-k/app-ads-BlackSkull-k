<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BlackSkull-k Apps</title>

  <link rel="icon" type="image/png" sizes="16x16" href="images/bskFavicon16x.png">
  <link rel="icon" type="image/png" sizes="32x32" href="images/bskFavicon32x.png?v=2">
  <link rel="icon" type="image/png" sizes="48x48" href="images/bskFavicon48x.png">
  <link rel="icon" type="image/png" sizes="64x64" href="images/bskFavicon64x.png">
  <link rel="icon" type="image/png" sizes="96x96" href="images/bskFavicon96x.png">
  <link rel="apple-touch-icon" sizes="180x180" href="images/bskFavicon180x.png">

  <link rel="icon" type="image/png" sizes="192x192" href="images/bskFavicon192x.png?v=1">
  <link rel="icon" type="image/png" sizes="512x512" href="images/bskFavicon512x.png?v=1">

  <link rel="manifest" href="/manifest.json">

  <meta name="theme-color" content="#000000">

  <meta name="google-site-verification" content="p3WxNMSzZRIBQIWVgAqcBhdaD6CRG99rZ3fTvgYM1I8" />

  <meta name="description" content="Scopri tutte le app di BlackSkull-k, giochi e utility Android gratuiti.">
  <meta name="keywords" content="app, applicazioni, giochi, BlackSkull-k, affiliati, Android, utility, giochi gratuiti">
  <meta name="author" content="BlackSkull-k">

  <meta property="og:title" content="BlackSkull-k Apps">
  <meta property="og:description" content="Scopri tutte le app di BlackSkull-k, giochi e utility Android gratuiti.">
  <meta property="og:image" content="images/bskFavicon180x.png">
  <meta property="og:url" content="https://blackskullk.netlify.app/">
  <meta property="og:type" content="website">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="BlackSkull-k Apps">
  <meta name="twitter:description" content="Scopri tutte le app di BlackSkull-k, giochi e utility Android gratuiti.">
  <meta name="twitter:image" content="images/bskFavicon180x.png">

  <meta name="admob-app-id" content="ca-app-pub-6870698456420623~YOUR_APP_ID">
  
  <style>
    /* STILE GENERALE */
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background: #9d9f9f;
      color: #333;
      display: flex;
      flex-direction: column;
    }
    header img { 
      width:100%; 
      max-height:200px; 
      object-fit:cover; 
      box-shadow:0 4px 10px rgba(0,0,0,0.5);
      margin-bottom: 10px; /* Aggiunto per coerenza con applications.html */
    }

    /* Navbar scrollabile con freccette */
    .navbar-container {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #2c3e50;
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
      padding: 10px 0;
    }

    .navbar {
      display: flex;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      scroll-behavior: smooth;
      padding: 0 30px; /* spazio per freccette */
    }

    .navbar a {
      color: #ecf0f1;
      text-decoration: none;
      padding: 10px 18px;
      margin: 0 8px;
      font-weight: 500;
      border-radius: 20px;
      transition: all 0.3s ease;
      flex: 0 0 auto;
    }

    .navbar a:hover { background-color: #34495e; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
    .navbar a.active { background-color: #0b47a1; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }

    /* Freccette */
    .nav-arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      color: #ecf0f1;
      font-size: 20px;
      background: rgba(0,0,0,0.3);
      border-radius: 50%;
      width: 30px;
      height: 30px;
      line-height: 30px;
      text-align: center;
      cursor: pointer;
      user-select: none;
      z-index: 10;
      display: none; /* di default nascoste */
    }
    .nav-arrow:hover { background: rgba(0,0,0,0.5); }

    .nav-left { left: 5px; }
    .nav-right { right: 5px; }

    /* Contenuto principale */
    main {
      flex: 1;
      max-width:1000px;
      margin:20px auto;
      padding:10px;
    }
    .section { margin-bottom:30px; padding:10px; }
    .divider { height:2px; background:#222; margin:20px 0; border-radius:2px; }

    h2 { margin-bottom:15px; text-align:center; color:#0b47a1; }

    /* CARDS APP */
    .apps-grid { display:flex; flex-wrap:wrap; justify-content:center; gap:15px; }
    .card {
      background:#fff; 
      border-radius:10px; 
      width:180px; 
      padding:15px; 
      display:flex; 
      flex-direction:column; 
      align-items:center; 
      box-shadow:0 3px 6px rgba(0,0,0,0.1); 
      transition: transform 0.3s ease, box-shadow 0.3s ease, opacity 0.5s ease;
      opacity: 0; transform: translateY(20px);
    }
    .card.visible { opacity:1; transform: translateY(0); }
    .card:hover, .card:active { transform: scale(1.05); box-shadow:0 15px 25px rgba(0,0,0,0.35); }
    .card img { width:80px; height:80px; margin-bottom:10px; }
    .card span { font-weight:bold; margin-bottom:10px; text-align:center; }
    .card a { text-decoration:none; color:#fff; background:#28a745; padding:6px 12px; border-radius:5px; font-weight:bold; }
    .card a:hover { background:#218838; }

    @media (max-width: 600px) {
      .card { width:45%; padding:12px; }
      .card img { width:70px; height:70px; }
      .card span { font-size:0.9em; }
      .card:active { transform: scale(1.08); box-shadow:0 20px 30px rgba(0,0,0,0.4); }
    }

    /* CONTATTI */
    .contact a { color:#1a73e8; text-decoration:none; font-weight:bold; }
    .contact a:hover { text-decoration:underline; }

    /* PULSANTI ADS */
    .ads-buttons { display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-top:10px; }
    .btn-view { background:#fcd116; } 
    .btn-download { background:#f57c00; } 
    .btn-view, .btn-download { color:#fff; text-decoration:none; padding:6px 12px; border-radius:5px; font-weight:bold; }
    .btn-view:hover { background:#e6c200; }
    .btn-download:hover { background:#d26900; }

    /* FOOTER */
    .bottom-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background-color: #2c3e50;
      color: #f0f0f0;
      text-align: center;
      padding: 10px 0;
      font-size: 14px;
      box-shadow: 0 -2px 5px rgba(0,0,0,0.3);
      z-index: 1000;
    }
    .content { padding-bottom: 60px; }

    /* ADMOB CARD */
    .admob-card {
      display:flex;
      flex-direction:column;
      align-items:center;
      background:#fff;
      padding:20px;
      border-radius:10px;
      box-shadow:0 3px 6px rgba(0,0,0,0.1);
      max-width:200px;
      margin:0 auto;
      transition: all 0.3s ease;
    }
    .admob-card:hover { transform: translateY(-5px); box-shadow:0 10px 20px rgba(0,0,0,0.25);}

    /* STILI AGGIUNTIVI PER LA CHAT GEMINI */
    .gemini-chat-container {
        max-width: 800px;
        margin: 20px auto;
        /* Nuovo colore di sfondo del container principale */
        background: #73a0ce;
        border-radius: 10px;
        box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        padding: 20px;
        display: flex;
        flex-direction: column;
    }
    #chat-history {
        height: 300px;
        overflow-y: auto;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 10px;
        margin-bottom: 10px;
        display: flex;
        flex-direction: column;
        /* Nuovo colore di sfondo della chat interna */
        background: #e0e9f4;
    }
    .message {
        padding: 8px 12px;
        border-radius: 15px;
        margin-bottom: 10px;
        max-width: 80%;
    }
    .message.user {
        background-color: #0b47a1;
        color: white;
        align-self: flex-end;
    }
    .message.gemini {
        background-color: #e0e0e0;
        color: #333;
        align-self: flex-start;
        white-space: pre-wrap;
    }
    #chat-input-container {
        display: flex;
        gap: 10px;
    }
    #chat-input {
        flex-grow: 1;
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #ccc;
    }
    #chat-send-btn {
        padding: 10px 20px;
        background-color: #28a745;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
    }
    #chat-send-btn:hover {
        background-color: #218838;
    }
    .loading-indicator {
      font-style: italic;
      color: #777;
      text-align: center;
    }
  </style>
</head>
<body>

<header>
  <img src="images/Logo1.png" alt="BlackSkull-k Logo">
</header>

<div class="navbar-container">
  <div class="nav-arrow nav-left">&#10094;</div>
  <div class="navbar">
    <a href="index.html" class="active">Home</a>
    <a href="applications.html">Applications</a>
    <a href="flashgames.html">Flash Games</a>
    <a href="contacts.html">Contacts</a>
    <a href="affiliate.html">Affiliate Sites</a>
  </div>
  <div class="nav-arrow nav-right">&#10095;</div>
</div>

<main class="content">
  <div class="apps-grid">
    <div class="card">
      <span>Piano</span>
      <img src="images/Pianoicon.png" alt="Piano">
      <a href="https://play.google.com/store/apps/details?id=com.PianoBlackskullk.com" target="_blank">Open</a>
    </div>
    <div class="card">
      <span>Torch Flash Light Plus</span>
      <img src="images/Torchicon.png" alt="Torch Flash Light Plus">
      <a href="https://play.google.com/store/apps/details?id=com.TorchFlashLightPlusBlackskullk.com" target="_blank">Open</a>
    </div>
    <div class="card">
      <span>Memojiing</span>
      <img src="images/Memoicon.png" alt="Memojiing">
      <a href="https://play.google.com/store/apps/details?id=com.memojingblackskullk.com" target="_blank">Open</a>
    </div>
    <div class="card">
      <span>Infinity Jump Rabbit</span>
      <img src="images/IJRicon.png" alt="Infinity Jump Rabbit">
      <a href="https://play.google.com/store/apps/details?id=com.infinityjumprabbit.com" target="_blank">Open</a>
    </div>
    <div class="card">
      <span>Golf Wild</span>
      <img src="images/Golficon.png" alt="Golf Wild">
      <a href="https://play.google.com/store/apps/details?id=com.golfwildblackskullk.com" target="_blank">Open</a>
    </div>
  </div>
  
  <div class="divider"></div>

  <div class="section gemini-chat-container">
    <h2>AI Chat Assistant</h2>
    <div id="chat-history"></div>
    <div id="chat-input-container">
        <input type="text" id="chat-input" placeholder="Chiedi qualcosa sulle app di BlackSkull-k...">
        <button id="chat-send-btn">Invia</button>
    </div>
  </div>

  <div class="divider"></div>

  <div class="section contact" id="contact">
    <div class="admob-card" style="max-width:200px;">
      <a href="https://play.google.com/store/apps/dev?id=6316655378671230760&hl=it" style="color:inherit; text-decoration:none;">
        <img src="images/PlayStoreicon.png" alt="BlackSkull-k Developer Page on Play Store" style="width:100%; max-width:150px; height:auto; display:block; margin:0 auto;">
      </a>
    </div>
  </div>

  <div class="divider"></div>

  <div class="section" id="ads">
    <h2>AdMob</h2>
    <div class="admob-card">
      <span>app-ads.txt file for AdMob</span>
      <div class="ads-buttons">
        <a href="https://blackskullk.netlify.app/app-ads.txt" class="btn-view" target="_blank">View</a>
        <a href="https://blackskullk.netlify.app/app-ads.txt" class="btn-download" download>Download</a>
      </div>
    </div>
  </div>
</main>

<div class="bottom-bar">
    BlackSkull-k ® 2021-2025
</div>

<script>
  // API Gemini Configuration
  const GEMINI_API_URL = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=";
  const API_KEY = "AIzaSyDo37G-qaDHLYTCNWitIiBQ5nyhnp9uigQ";
  const MAX_RETRIES = 5;
  const INITIAL_DELAY = 1000;

  // Cronologia della chat
  let chatHistory = [];
  const systemPrompts = {
      'it': "Sei un assistente virtuale per il sito web BlackSkull-k. Rispondi alle domande degli utenti in modo amichevole e utile in italiano. Il tuo obiettivo è fornire informazioni sulle app e sul sito, promuovendo la navigazione e l'uso delle funzionalità. Ecco alcune app che il sito offre: Piano, Torch Flash Light Plus, Memojiing, Infinity Jump Rabbit, Golf Wild.",
      'en': "You are a virtual assistant for the BlackSkull-k website. Answer user questions in a friendly and helpful way in English. Your goal is to provide information about the apps and the website, promoting navigation and the use of its features. Here are some apps the site offers: Piano, Torch Flash Light Plus, Memojiing, Infinity Jump Rabbit, Golf Wild.",
      'es': "Eres un asistente virtual para el sitio web de BlackSkull-k. Responde a las preguntas de los usuarios de forma amigable y útil en español. Tu objetivo es proporcionar información sobre las aplicaciones y el sitio web, promoviendo la navegación y el uso de sus funciones. Aquí hay algunas aplicaciones que el sitio ofrece: Piano, Torch Flash Light Plus, Memojiing, Infinity Jump Rabbit, Golf Wild."
  };
  
  const placeholderTexts = {
      'it': "Chiedi qualcosa sulle app di BlackSkull-k...",
      'en': "Ask something about BlackSkull-k apps...",
      'es': "Pregunta algo sobre las aplicaciones de BlackSkull-k..."
  };

  const sendButtonTexts = {
    'it': "Invia",
    'en': "Send",
    'es': "Enviar"
  };

  function getLanguage() {
      const userLang = navigator.language.split('-')[0];
      return userLang;
  }
  
  function getPromptForLanguage() {
      const userLang = getLanguage();
      return systemPrompts[userLang] || systemPrompts['it'];
  }
  
  function setPlaceholderForLanguage() {
      const userLang = getLanguage();
      const placeholder = placeholderTexts[userLang] || placeholderTexts['it'];
      document.getElementById('chat-input').placeholder = placeholder;
  }
  
  function setSendButtonTextForLanguage() {
      const userLang = getLanguage();
      const buttonText = sendButtonTexts[userLang] || sendButtonTexts['it'];
      document.getElementById('chat-send-btn').textContent = buttonText;
  }

  async function callGeminiApi(history) {
    let delay = INITIAL_DELAY;
    for (let i = 0; i < MAX_RETRIES; i++) {
      try {
        const response = await fetch(GEMINI_API_URL + API_KEY, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ contents: history })
        });

        if (response.status === 429) {
          await new Promise(resolve => setTimeout(resolve, delay));
          delay *= 2;
          continue;
        }

        if (!response.ok) {
          throw new Error(`API call failed with status: ${response.status}`);
        }

        const result = await response.json();
        if (result.candidates && result.candidates.length > 0 &&
            result.candidates[0].content && result.candidates[0].content.parts &&
            result.candidates[0].content.parts.length > 0) {
          return result.candidates[0].content.parts[0].text;
        } else {
          throw new Error("Invalid response structure from Gemini API");
        }
      } catch (error) {
        console.error("Gemini API error:", error);
        if (i === MAX_RETRIES - 1) {
          return "Si è verificato un errore durante la comunicazione con il modello.";
        }
      }
    }
  }

  // Gestione della chat
  const chatHistoryDiv = document.getElementById("chat-history");
  const chatInput = document.getElementById("chat-input");
  const chatSendBtn = document.getElementById("chat-send-btn");

  function addMessageToChat(text, sender) {
    const messageDiv = document.createElement("div");
    messageDiv.classList.add("message", sender);
    messageDiv.textContent = text;
    chatHistoryDiv.appendChild(messageDiv);
    chatHistoryDiv.scrollTop = chatHistoryDiv.scrollHeight; // Scrolla in basso
  }

  async function sendMessage() {
    const userMessage = chatInput.value.trim();
    if (userMessage === "") return;

    addMessageToChat(userMessage, "user");
    chatInput.value = "";

    // Aggiungi il messaggio dell'utente alla cronologia
    chatHistory.push({ role: "user", parts: [{ text: userMessage }] });

    // Messaggio di caricamento
    const loadingMessage = document.createElement("div");
    loadingMessage.classList.add("loading-indicator");
    loadingMessage.textContent = "Sto pensando...";
    chatHistoryDiv.appendChild(loadingMessage);
    chatHistoryDiv.scrollTop = chatHistoryDiv.scrollHeight;

    const geminiResponse = await callGeminiApi(chatHistory);

    // Rimuovi il messaggio di caricamento
    chatHistoryDiv.removeChild(loadingMessage);

    addMessageToChat(geminiResponse, "gemini");

    // Aggiungi la risposta di Gemini alla cronologia
    chatHistory.push({ role: "model", parts: [{ text: geminiResponse }] });
  }

  chatSendBtn.addEventListener("click", sendMessage);
  chatInput.addEventListener("keydown", (e) => {
    if (e.key === "Enter") {
      sendMessage();
    }
  });

  // Animazione fade-in + slide delle card
  document.addEventListener("DOMContentLoaded", function() {
    const cards = document.querySelectorAll(".card");
    cards.forEach((card, index) => {
      setTimeout(() => card.classList.add("visible"), index * 150);
    });
    
    // Inizializza la cronologia della chat con il prompt di sistema
    chatHistory = [{ role: "user", parts: [{ text: getPromptForLanguage() }] }];
    
    // Imposta il placeholder e il testo del pulsante
    setPlaceholderForLanguage();
    setSendButtonTextForLanguage();
  });

  // Gestione freccette navbar
  const nav = document.querySelector('.navbar');
  const leftArrow = document.querySelector('.nav-left');
  const rightArrow = document.querySelector('.nav-right');

  function updateArrows() {
    if (nav.scrollWidth > nav.clientWidth) {
      leftArrow.style.display = nav.scrollLeft > 0 ? "block" : "none";
      rightArrow.style.display = (nav.scrollLeft + nav.clientWidth < nav.scrollWidth) ? "block" : "none";
    } else {
      leftArrow.style.display = "none";
      rightArrow.style.display = "none";
    }
  }

  leftArrow.addEventListener('click', () => {
    nav.scrollBy({ left: -150, behavior: 'smooth' });
  });
  rightArrow.addEventListener('click', () => {
    nav.scrollBy({ left: 150, behavior: 'smooth' });
  });

  nav.addEventListener('scroll', updateArrows);
  window.addEventListener('resize', updateArrows);
  window.addEventListener('load', updateArrows);
</script>
  
</body>
</html>
