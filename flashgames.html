<!DOCTYPE ahtml>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BlackSkull-k Apps - Flash Games</title>
<link rel="icon" type="image/png" sizes="32x32" href="images/bskFavicon32x.png">
<link rel="apple-touch-icon" sizes="180x180" href="images/bskFavicon180x.png">
<link rel="manifest" href="/manifest.json">
<style>
/* STILE GENERALE */
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  font-family: Arial, sans-serif;
  background: #9d9f9f;
  color: #333;
  display: flex;
  flex-direction: column;
}

header img {
  width: 100%;
  max-height: 200px;
  object-fit: cover;
  box-shadow: 0 4px 10px rgba(0,0,0,0.5);
  margin-bottom: 10px;
}

/* Navbar scrollabile con freccette */
.navbar-container {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #2c3e50;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  padding: 10px 0;
}

.navbar {
  display: flex;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
  padding: 0 30px;
}

.navbar a {
  color: #ecf0f1;
  text-decoration: none;
  padding: 10px 18px;
  margin: 0 8px;
  font-weight: 500;
  border-radius: 20px;
  transition: all 0.3s ease;
  flex: 0 0 auto;
}

.navbar a:hover { background-color: #34495e; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
.navbar a.active { background-color: #0b47a1; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }

/* Freccette */
.nav-arrow {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  color: #ecf0f1;
  font-size: 20px;
  background: rgba(0,0,0,0.3);
  border-radius: 50%;
  width: 30px;
  height: 30px;
  line-height: 30px;
  text-align: center;
  cursor: pointer;
  user-select: none;
  z-index: 10;
  display: none;
}
.nav-arrow:hover { background: rgba(0,0,0,0.5); }

.nav-left { left: 5px; }
.nav-right { right: 5px; }

main {
  flex: 1;
  max-width: 1000px;
  margin: 20px auto;
  padding: 10px;
}
h2 { margin-bottom: 15px; text-align: center; color: #0b47a1; }

.content { padding-bottom: 60px; }

/* Barra inferiore */
.bottom-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background-color: #2c3e50;
  color: #f0f0f0;
  text-align: center;
  padding: 10px 0;
  font-size: 14px;
  box-shadow: 0 -2px 5px rgba(0,0,0,0.3);
  z-index: 1000;
}

/* STILE DEL GIOCO SNAKE */
#gameCanvas {
  display: block;
  margin: 0 auto;
  background: #000;
  border: 2px solid #222;
  border-radius: 10px;
}

#snake-game {
  text-align: center;
}

#startBtn {
  background-color: #1e2db6;
  color: #ffffff;
  border: none;
  padding: 10px 20px;
  font-size: 16px;
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.3s;
  margin-top: 20px;
  display: block;
  margin-left: auto;
  margin-right: auto;
  box-shadow: 0 4px 8px rgba(0,0,0,0.4);
}

#startBtn:hover {
  background-color: #162090;
  box-shadow: 0 6px 12px rgba(0,0,0,0.5);
}
</style>
</head>
<body>

<header>
  <img src="images/Logo1.png" alt="BlackSkull-k Logo">
</header>

<div class="navbar-container">
  <div class="nav-arrow nav-left">&#10094;</div>
  <div class="navbar">
    <a href="index.html">Home</a>
    <a href="applications.html">Applications</a>
    <a href="flashgames.html" class="active">Flash Games</a>
    <a href="contacts.html">Contacts</a>
    <a href="affiliatesites.html">Affiliate Sites</a>
  </div>
  <div class="nav-arrow nav-right">&#10095;</div>
</div>

<main class="content">
  <h2>Flash Games</h2>
  <div class="section" id="snake-game">
    <h2>Snake Game</h2>
    <canvas id="gameCanvas"></canvas>
    <button id="startBtn">Start</button>
  </div>
</main>

<div class="bottom-bar">
    BlackSkull-k 2021 2025
</div>

<script>
// Gestione freccette navbar
const nav = document.querySelector('.navbar');
const leftArrow = document.querySelector('.nav-left');
const rightArrow = document.querySelector('.nav-right');

function updateArrows() {
  if (nav.scrollWidth > nav.clientWidth) {
    leftArrow.style.display = nav.scrollLeft > 0 ? "block" : "none";
    rightArrow.style.display = (nav.scrollLeft + nav.clientWidth < nav.scrollWidth) ? "block" : "none";
  } else {
    leftArrow.style.display = "none";
    rightArrow.style.display = "none";
  }
}

leftArrow.addEventListener('click', () => {
  nav.scrollBy({ left: -150, behavior: 'smooth' });
});
rightArrow.addEventListener('click', () => {
  nav.scrollBy({ left: 150, behavior: 'smooth' });
});

nav.addEventListener('scroll', updateArrows);
window.addEventListener('resize', updateArrows);
window.addEventListener('load', updateArrows);
</script>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// Suoni
const gameOverSound = new Audio("https://www.myinstants.com/media/sounds/snake-death-scream.mp3");
const eatSound = new Audio("https://www.myinstants.com/media/sounds/snake-game-food.mp3");

let gridSize = 21;
let box;
let snake = [{x: 0, y: 0}];
let food;
let sparks = [];
let score = 0;
let bestScore = 0;
let d = "RIGHT";
let nextD = "RIGHT";
let gameRunning = false;
let lastTime = 0, speed = 4;
let flashing = 0;

// resize canvas
function resizeCanvas() {
  const size = Math.min(window.innerWidth * 0.9, 400);
  box = Math.floor(size / gridSize);
  canvas.width = box * gridSize;
  canvas.height = box * gridSize;
  food = randomFood();
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

// prevenzione scroll frecce
document.addEventListener("keydown", e => {
  if(e.key === "ArrowUp" && d !== "DOWN") { nextD="UP"; e.preventDefault(); }
  else if(e.key === "ArrowDown" && d !== "UP") { nextD="DOWN"; e.preventDefault(); }
  else if(e.key === "ArrowLeft" && d !== "RIGHT") { nextD="LEFT"; e.preventDefault(); }
  else if(e.key === "ArrowRight" && d !== "LEFT") { nextD="RIGHT"; e.preventDefault(); }
});

// genera cibo
function randomFood() {
  let valid = false;
  let newFood;
  while(!valid){
    newFood = { 
      x: Math.floor(Math.random()*gridSize)*box, 
      y: Math.floor(Math.random()*gridSize)*box 
    };
    valid = !snake.some(segment => segment.x === newFood.x && segment.y === newFood.y);
  }
  return newFood;
}

// disegno
function draw() {
  ctx.fillStyle = "#000";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // punteggi
  ctx.fillStyle = "#fff";
  ctx.font = `${box}px Arial`;
  ctx.fillText("Score: " + score, box, box*1.2);
  ctx.fillText("Best: " + bestScore, box, box*2.3);

  // bordo rosso lampeggiante
  if(flashing > 0) {
    ctx.strokeStyle = "red";
    ctx.lineWidth = 4;
    ctx.strokeRect(0,0,canvas.width,canvas.height);
    flashing--;
  }

  // Snake
  ctx.fillStyle = "#0f0";
  snake.forEach(segment => ctx.fillRect(segment.x, segment.y, box, box));

  // Food
  ctx.fillStyle = "#f00";
  ctx.fillRect(food.x, food.y, box, box);

  // Scintille
  sparks.forEach((s, i) => {
    ctx.fillStyle = `rgba(255,255,0,${s.life/10})`;
    ctx.fillRect(s.x, s.y, 2, 2);
    s.x += s.dx; s.y += s.dy; s.life--;
    if(s.life <= 0) sparks.splice(i,1);
  });

  // direzione
  d = nextD;

  // movimento testa
  let head = { ...snake[0] };
  if(d==="LEFT") head.x -= box;
  else if(d==="RIGHT") head.x += box;
  else if(d==="UP") head.y -= box;
  else if(d==="DOWN") head.y += box;

  // collisione
  if(head.x<0 || head.x>=canvas.width || head.y<0 || head.y>=canvas.height || 
     snake.some(s=>s.x===head.x && s.y===head.y)){
    gameOverSound.currentTime = 0;
    gameOverSound.play();
    gameRunning = false;
    flashing = 6;

    // aggiorna best
    if(score > bestScore) bestScore = score;

    document.getElementById("startBtn").textContent = "Restart";

  } else {
    snake.unshift(head);
    if(head.x === food.x && head.y === food.y){
      score++;
      eatSound.currentTime = 0;
      eatSound.play();
      sparks.push(...Array(20).fill().map(() => ({
        x:food.x+box/2, y:food.y+box/2, life:10, dx:Math.random()*2-1, dy:Math.random()*2-1
      })));
      food = randomFood();
    } else snake.pop();
  }
}

// pulsante start/restart
document.getElementById("startBtn").addEventListener("click", () => {
  snake = [{x:0,y:0}];
  score = 0;
  d = "RIGHT";
  nextD = "RIGHT";
  sparks = [];
  food = randomFood();
  gameRunning = true;
  lastTime = 0;
  document.getElementById("startBtn").textContent = "Restart";
  requestAnimationFrame(gameLoop);
});

// loop
function gameLoop(time){
  if(!gameRunning) return;
  if(time - lastTime > 1000/speed){
    draw();
    lastTime = time;
  }
  requestAnimationFrame(gameLoop);
}

// swipe touch
let touchStartX = 0;
let touchStartY = 0;
canvas.addEventListener("touchstart", e => {
  const touch = e.touches[0];
  touchStartX = touch.clientX;
  touchStartY = touch.clientY;
});
canvas.addEventListener("touchmove", e => {
  e.preventDefault(); 
}, { passive: false });
canvas.addEventListener("touchend", e => {
  const touch = e.changedTouches[0];
  const dx = touch.clientX - touchStartX;
  const dy = touch.clientY - touchStartY;

  if(Math.abs(dx) > Math.abs(dy)) {
    if(dx > 0 && d !== "LEFT") nextD = "RIGHT";
    else if(dx < 0 && d !== "RIGHT") nextD = "LEFT";
  } else {
    if(dy > 0 && d !== "UP") nextD = "DOWN";
    else if(dy < 0 && d !== "DOWN") nextD = "UP";
  }
});
</script>

</body>
</html>
