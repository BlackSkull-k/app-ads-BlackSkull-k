<!DOCTYPE ahtml>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BlackSkull-k Apps - Flash Games</title>
<link rel="icon" type="image/png" sizes="32x32" href="images/bskFavicon32x.png">
<link rel="apple-touch-icon" sizes="180x180" href="images/bskFavicon180x.png">
<link rel="manifest" href="/manifest.json">
<style>
/* STILE GENERALE */
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  font-family: Arial, sans-serif;
  background: #9d9f9f;
  color: #333;
  display: flex;
  flex-direction: column;
}

header img {
  width: 100%;
  max-height: 200px;
  object-fit: cover;
  box-shadow: 0 4px 10px rgba(0,0,0,0.5);
  margin-bottom: 10px;
}

/* Navbar scrollabile con freccette */
.navbar-container {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #2c3e50;
  box-shadow: 0 4px 6px rgba(0,0,0,0.5);
  overflow: hidden;
  border-radius: 5px;
  margin-bottom: 20px;
}

.navbar {
  display: flex;
  gap: 15px;
  padding: 10px;
  overflow-x: auto;
  scrollbar-width: none;
  -ms-overflow-style: none;
  scroll-behavior: smooth;
}

.navbar::-webkit-scrollbar {
  display: none;
}

.navbar a {
  text-decoration: none;
  color: #ecf0f1;
  padding: 8px 15px;
  border-radius: 5px;
  transition: background-color 0.3s;
  white-space: nowrap;
}

.navbar a:hover {
  background-color: #34495e;
}

.nav-arrow {
  background-color: rgba(44, 62, 80, 0.8);
  color: #ecf0f1;
  border: none;
  padding: 10px;
  cursor: pointer;
  z-index: 10;
  transition: background-color 0.3s;
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  display: none;
}

.nav-arrow.left {
  left: 0;
  border-radius: 0 5px 5px 0;
}

.nav-arrow.right {
  right: 0;
  border-radius: 5px 0 0 5px;
}

.nav-arrow:hover {
  background-color: #34495e;
}

main {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

h2 {
  color: #2c3e50;
  margin-top: 0;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
}

.games-container {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 20px;
  padding-bottom: 20px;
}

.game-card {
  background: #f4f4f4;
  border-radius: 10px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  padding: 20px;
  width: 300px;
  text-align: center;
  transition: transform 0.3s, box-shadow 0.3s;
}

.game-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 6px 12px rgba(0,0,0,0.3);
}

.game-card h3 {
  color: #2c3e50;
  margin-top: 0;
}

.game-card p {
  color: #555;
}

.game-card img {
  width: 100%;
  border-radius: 5px;
  margin-bottom: 10px;
}

.game-card button {
  background-color: #2ecc71;
  color: white;
  border: none;
  padding: 10px 20px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin-top: 10px;
  cursor: pointer;
  border-radius: 5px;
  transition: background-color 0.3s;
}

.game-card button:hover {
  background-color: #27ae60;
}

.bottom-bar {
    background-color: #2c3e50;
    color: #ecf0f1;
    text-align: center;
    padding: 10px 0;
    margin-top: auto;
    width: 100%;
    box-shadow: 0 -4px 6px rgba(0,0,0,0.5);
}

/* Modale */
.modal {
  display: none;
  position: fixed;
  z-index: 100;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.8);
  justify-content: center;
  align-items: center;
}

.modal-content {
  position: relative;
  background-color: #fefefe;
  padding: 20px;
  border-radius: 10px;
  width: 90%;
  max-width: 800px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.5);
  text-align: center;
}

.close-button {
  color: #aaa;
  position: absolute;
  top: 10px;
  right: 25px;
  font-size: 28px;
  font-weight: bold;
  cursor: pointer;
}

.close-button:hover,
.close-button:focus {
  color: black;
  text-decoration: none;
}

/* Stile per il gioco Snake */
#game-modal .modal-content {
  background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://i.imgur.com/kS5s6s2.png') no-repeat center center fixed;
  background-size: cover;
}

#gameCanvas {
  border: 2px solid #3498db;
  box-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
  background-color: rgba(0, 0, 0, 0.7);
}

#game-ui {
  display: flex;
  justify-content: space-between;
  width: 100%;
  max-width: 400px;
  color: white;
  font-weight: bold;
  text-shadow: 1px 1px 2px black;
  margin-top: 10px;
}

#game-ui span {
  font-size: 1.2em;
}

#startBtn {
  background-color: #e74c3c;
}
#startBtn:hover {
  background-color: #c0392b;
}

#game-over-overlay {
  display: none;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  color: white;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
}

#game-over-overlay h3 {
  font-size: 3em;
  margin: 0;
}

#game-over-overlay p {
  font-size: 1.5em;
  margin: 10px 0;
}

@media (max-width: 600px) {
  #gameCanvas {
    width: 90vw;
    height: 90vw;
  }
}
</style>
</head>
<body>

<header>
  <img src="images/bsk-banner.jpg" alt="BlackSkull-k Apps Banner">
</header>

<div class="navbar-container">
    <button class="nav-arrow left nav-left">&#8249;</button>
    <div class="navbar">
      <a href="index.html">Home</a>
      <a href="projects.html">Projects</a>
      <a href="flashgames.html">Flash Games</a>
      <a href="apps.html">Apps</a>
      <a href="contacts.html">Contacts</a>
    </div>
    <button class="nav-arrow right nav-right">&#8250;</button>
</div>

<main>
  <h2>Flash Games</h2>
  <div class="games-container">
    <div class="game-card">
      <h3>Snake Game</h3>
      <p>Un classico senza tempo: mangia il cibo per crescere ed evita di scontrarti con te stesso o con i bordi!</p>
      <button id="open-snake-btn">Play</button>
    </div>
  </div>
</main>

<div class="bottom-bar">
    BlackSkull-k 2021 2025
</div>

<div id="game-modal" class="modal">
  <div class="modal-content">
    <span class="close-button">&times;</span>
    <div id="game-ui">
      <span>Score: <span id="score">0</span></span>
      <span>Best: <span id="best-score">0</span></span>
    </div>
    <canvas id="gameCanvas" width="400" height="400"></canvas>
    <div id="game-over-overlay">
      <h3 id="gameOverMessage">GAME OVER</h3>
      <p>Score: <span id="final-score">0</span></p>
      <button id="startBtn">Start</button>
    </div>
  </div>
</div>

<script>
// Gestione freccette navbar
const nav = document.querySelector('.navbar');
const leftArrow = document.querySelector('.nav-left');
const rightArrow = document.querySelector('.nav-right');

function updateArrows() {
  if (nav.scrollWidth > nav.clientWidth) {
    leftArrow.style.display = nav.scrollLeft > 0 ? "block" : "none";
    rightArrow.style.display = (nav.scrollLeft + nav.clientWidth < nav.scrollWidth) ? "block" : "none";
  } else {
    leftArrow.style.display = "none";
    rightArrow.style.display = "none";
  }
}

leftArrow.addEventListener('click', () => {
  nav.scrollBy({ left: -150, behavior: 'smooth' });
});
rightArrow.addEventListener('click', () => {
  nav.scrollBy({ left: 150, behavior: 'smooth' });
});

window.addEventListener('resize', updateArrows);
document.addEventListener('DOMContentLoaded', updateArrows);


// Logica del gioco Snake
const openSnakeBtn = document.getElementById('open-snake-btn');
const gameModal = document.getElementById('game-modal');
const closeBtn = document.querySelector('#game-modal .close-button');
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const scoreSpan = document.getElementById('score');
const bestScoreSpan = document.getElementById('best-score');
const finalScoreSpan = document.getElementById('final-score');
const gameOverOverlay = document.getElementById('game-over-overlay');
const startBtn = document.getElementById('startBtn');
const gameOverMessage = document.getElementById('gameOverMessage');

const box = 20;
let snake = [{x: 0, y: 0}];
let food = {};
let score = 0;
let bestScore = localStorage.getItem("snakeBestScore") || 0;
let d;
let nextD;
let gameRunning = false;
let flashing = 0;
let sparks = [];
let lastTime = 0;

bestScoreSpan.textContent = bestScore;

// Caricamento dei suoni
const eatSound = new Audio('https://freesound.org/data/previews/277/277215_4938640-lq.mp3');
const gameOverSound = new Audio('https://freesound.org/data/previews/533/533034_11867154-lq.mp3');

// Gestione Modale
openSnakeBtn.addEventListener('click', () => {
  gameModal.style.display = 'flex';
  startBtn.textContent = 'Start';
  if (gameRunning) {
    gameRunning = false;
  }
});

closeBtn.addEventListener('click', () => {
  gameModal.style.display = 'none';
  gameRunning = false;
  gameOverOverlay.style.display = 'none';
});

window.addEventListener('click', e => {
  if (e.target === gameModal) {
    gameModal.style.display = 'none';
    gameRunning = false;
    gameOverOverlay.style.display = 'none';
  }
});

document.addEventListener('keydown', e => {
  if (!gameRunning) return;
  const key = e.key;
  if (key === 'ArrowLeft' && d !== 'RIGHT' && nextD !== 'RIGHT') nextD = 'LEFT';
  else if (key === 'ArrowUp' && d !== 'DOWN' && nextD !== 'DOWN') nextD = 'UP';
  else if (key === 'ArrowRight' && d !== 'LEFT' && nextD !== 'LEFT') nextD = 'RIGHT';
  else if (key === 'ArrowDown' && d !== 'UP' && nextD !== 'UP') nextD = 'DOWN';
});

function randomFood() {
  return {
    x: Math.floor(Math.random() * (canvas.width / box)) * box,
    y: Math.floor(Math.random() * (canvas.height / box)) * box
  };
}

function checkCollision(head, array) {
  for (let i = 0; i < array.length; i++) {
    if (head.x === array[i].x && head.y === array[i].y) {
      return true;
    }
  }
  return false;
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  if (flashing > 0) {
    if (flashing % 2 === 0) {
      ctx.fillStyle = 'red';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
    }
    flashing--;
  }

  for (let i = 0; i < snake.length; i++) {
    ctx.fillStyle = (i === 0) ? '#2ecc71' : '#27ae60';
    ctx.fillRect(snake[i].x, snake[i].y, box, box);
    ctx.strokeStyle = '#2c3e50';
    ctx.strokeRect(snake[i].x, snake[i].y, box, box);
  }

  ctx.fillStyle = '#e74c3c';
  ctx.fillRect(food.x, food.y, box, box);

  sparks.forEach(spark => {
    spark.life--;
    if (spark.life > 0) {
      spark.x += spark.dx;
      spark.y += spark.dy;
      ctx.fillStyle = `rgba(231, 76, 60, ${spark.life / 10})`;
      ctx.fillRect(spark.x, spark.y, 2, 2);
    }
  });

  sparks = sparks.filter(spark => spark.life > 0);

  const snakeX = snake[0].x;
  const snakeY = snake[0].y;
  
  d = nextD;

  let newHead = {x: snakeX, y: snakeY};

  if (d === 'LEFT') newHead.x -= box;
  else if (d === 'UP') newHead.y -= box;
  else if (d === 'RIGHT') newHead.x += box;
  else if (d === 'DOWN') newHead.y += box;

  if (
    newHead.x < 0 || newHead.x >= canvas.width ||
    newHead.y < 0 || newHead.y >= canvas.height ||
    checkCollision(newHead, snake)
  ) {
    gameRunning = false;
    gameOverSound.currentTime = 0;
    gameOverSound.play();
    flashing = 6;
    finalScoreSpan.textContent = score;
    gameOverOverlay.style.display = "flex";

    if (score > bestScore) {
      bestScore = score;
      bestScoreSpan.textContent = bestScore;
      localStorage.setItem("snakeBestScore", bestScore);
    }
    return;
  }

  snake.unshift(newHead);

  if (newHead.x === food.x && newHead.y === food.y) {
    score++;
    scoreSpan.textContent = score;
    eatSound.currentTime = 0;
    eatSound.play();
    sparks.push(...Array(20).fill().map(() => ({
      x: food.x + box / 2, y: food.y + box / 2, life: 10, dx: Math.random() * 2 - 1, dy: Math.random() * 2 - 1
    })));
    food = randomFood();
  } else {
    snake.pop();
  }
}

// pulsante start/restart
document.getElementById("startBtn").addEventListener("click", () => {
  snake = [{x: 0, y: 0}];
  score = 0;
  d = "RIGHT";
  nextD = "RIGHT";
  sparks = [];
  food = randomFood();
  gameRunning = true;
  lastTime = 0;
  gameOverOverlay.style.display = "none";
  startBtn.textContent = "Restart";
  requestAnimationFrame(gameLoop);
});

// loop
function gameLoop(time){
  if(!gameRunning) return;
  if(time - lastTime > 1000/10){ // Aumenta la velocità per un gameplay più sfidante
    draw();
    lastTime = time;
  }
  requestAnimationFrame(gameLoop);
}

// swipe touch
let touchStartX = 0;
let touchStartY = 0;
canvas.addEventListener("touchstart", e => {
  const touch = e.touches[0];
  touchStartX = touch.clientX;
  touchStartY = touch.clientY;
}, { passive: false });
canvas.addEventListener("touchmove", e => {
  e.preventDefault(); 
}, { passive: false });
canvas.addEventListener("touchend", e => {
  const touch = e.changedTouches[0];
  const dx = touch.clientX - touchStartX;
  const dy = touch.clientY - touchStartY;

  if (Math.abs(dx) > Math.abs(dy)) {
    if (dx > 0 && d !== "LEFT" && nextD !== "LEFT") nextD = "RIGHT";
    else if (dx < 0 && d !== "RIGHT" && nextD !== "RIGHT") nextD = "LEFT";
  } else {
    if (dy > 0 && d !== "UP" && nextD !== "UP") nextD = "DOWN";
    else if (dy < 0 && d !== "DOWN" && nextD !== "DOWN") nextD = "UP";
  }
}, { passive: false });
</script>

</body>
</html>
